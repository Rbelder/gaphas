<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Interacting with diagrams &mdash; Gaphas v0.5 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '#',
        VERSION:     '0.5',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Gaphas v0.5 documentation" href="index.html" />
    <link rel="next" title="Ports" href="ports.html" />
    <link rel="prev" title="Class diagram" href="diagram.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="ports.html" title="Ports"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="diagram.html" title="Class diagram"
             accesskey="P">previous</a> |</li>
        <li><a href="contents.html">Gaphas v0.5 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="interacting-with-diagrams">
<h1>Interacting with diagrams<a class="headerlink" href="#interacting-with-diagrams" title="Permalink to this headline">¶</a></h1>
<p>Tools are used to handle user actions, like moving a mouse pointer over the
screen and clicking on items in the canvas.</p>
<p>Tools are registered on the <tt class="docutils literal"><span class="pre">View</span></tt>. They have some internal state (e.g. when and
where a mouse button was pressed). Therefore tools can not be reused by
different views <a class="footnote-reference" href="#id3" id="id1">[1]</a>.</p>
<p>For a certain action to happen multiple user events are used. For example a
click is a combination of a button press and button release event (only talking
mouse clicks now). In most cases also some movement is done. A sequence of a
button press, some movement and a button release is treated as one transaction.
Once a button is pressed the tool registers itself as the tool that will deal
with all subsequent events (a <tt class="docutils literal"><span class="pre">grab</span></tt>).</p>
<p>Several events can happen based on user events. E.g.:</p>
<ul class="simple">
<li>item is hovered over (motion)</li>
<li>item is hovered over while another item is being moved (<tt class="docutils literal"><span class="pre">press</span></tt>, <tt class="docutils literal"><span class="pre">motion</span></tt>)</li>
<li>item is hovered over while dragging something else (DnD; <tt class="docutils literal"><span class="pre">press</span></tt>, <tt class="docutils literal"><span class="pre">move</span></tt>)</li>
<li>grabbed (button press on item)</li>
<li>handle is grabbed (button press on handle)</li>
<li>center of line segment is grabbed (will cause segment to split; button press on line)</li>
<li>ungrabbed (button release)</li>
<li>move (item is moved -&gt; hover + grabbed)</li>
<li>key is pressed</li>
<li>key is released</li>
<li>modifier is pressed (e.g. may cause mouse pointer to change, giving a hit
about what a grab event will do.</li>
</ul>
<p>There is a lot of behaviour possible and it can depend on the kind of diagrams that are created what has to be done.</p>
<p>To organize the event sequences and keep some order in what the user is doing Tools are used. Tools define what has to happen (find a handle nearly the mouse cursor, move an item).</p>
<p>Gaphas contains a set of default tools. Each tool is ment to deal with a special part of the view. A list of responsibilities is also defined here:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">HoverTool:</th><td class="field-body"><p class="first">First thing a user wants to know is if the mouse cursor is over an item. The <tt class="docutils literal"><span class="pre">HoverTool</span></tt> makes that explicit.
- Find a handle or item, if found, mark it as the <tt class="docutils literal"><span class="pre">hovered_item</span></tt></p>
</td>
</tr>
<tr class="field"><th class="field-name" colspan="2">HandleTool and ConnectHandleTool:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">Handles are an important means to interact with items. They are used to
resize element, move lines and (in case of <tt class="docutils literal"><span class="pre">ConnectHandleTool</span></tt>) establish
connections between items. Handles are rendered on top of items so it makes
sense to deal with them before you deal with items.</p>
<ul class="simple">
<li>On click: find a handle, if found become the grabbed tool and set focus on the selected item. Deselected current selection based on modifier keys.</li>
<li>On motion: move the handle</li>
<li>On release: release grab and release the handle</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name">ItemTool:</th><td class="field-body"><p class="first">Items are the elements that are actually providing any (visual) meaning to the diagram. ItemTool deals with moving them around. The tool makes sure the right subset of selected elements are moved (e.g. you don&#8217;t want to move a nested item if its parent item is already moved, this gives funny visual effects)</p>
<ul class="simple">
<li>On click: find an item, if found become the grabbed tool and set the item as focused. Some extra behaviour regarding multiple select is also done here.</li>
<li>On motion: move the selected items (only the ones that have no selected parent items)</li>
<li>On release: release grab and release item</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name">RubberBandTool:</th><td class="field-body"><p class="first">If no handle or item is selected a rubberband selection is started.</p>
</td>
</tr>
<tr class="field"><th class="field-name" colspan="2">PanTool and ZoomTool:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">Handy tools for moving the canvas around and zooming in and out. Convenience functionality, basically.</p>
</td>
</tr>
<tr class="field"><th class="field-name">TextEditTool:</th><td class="field-body"><p class="first last">An experimental tool for editing onscreen text.</p>
</td>
</tr>
</tbody>
</table>
<p>All tools mentioned above are linked in a <tt class="docutils literal"><span class="pre">ToolChain</span></tt>. Only one tool can deal with a use event.</p>
<p>There is one more tool, that has not been mentioned yet:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">PlacementTool:</th><td class="field-body">A special tool to use for placing new items on the screen.</td>
</tr>
</tbody>
</table>
<p>As said, tools define <em>what</em> has to happen, they don&#8217;t say how. Take for example finding a handle: on a normal element (a box or something) that would mean find the handle in one of the corners. On a line, however, that may also mean a not-yet existing handle in the middle of a line segment (there is a functionality that splits the line segment).</p>
<p>The <em>how</em> is defined by so called aspects <a class="footnote-reference" href="#id4" id="id2">[2]</a>.</p>
<div class="section" id="separating-the-what-from-the-how">
<h2>Separating the <em>What</em> from the <em>How</em><a class="headerlink" href="#separating-the-what-from-the-how" title="Permalink to this headline">¶</a></h2>
<p>The <em>what</em> is decided in a tool. Based on this the <em>how</em> logic can be applied
to the item at hand. For example: if an item is clicked, it should be marked as
the focused item. Same for dragging: if an item is dragged it should be updated
based on the event information. It may even apply this to all other selected
items.</p>
<p>The how logic depends actually on the item it is applied to. Lines have different behaviours than boxes for example. In Gaphas this has been resolved by defining a generic methods. To put it simple: a generic method is a factory that returns a specific method (or instance of a class, as we do in gaphas) based on its parameters.</p>
<p>The advantage is that more complex behaviour can be composed. Since the
decision on what should happen is done in the tool, the aspect which is then
used to work on the item ensures a certain behaviour is performed.</p>
<img alt="_images/tools.png" src="_images/tools.png" style="width: 700px;" />
<p>The diagram above shows the relation between tools and their aspects. Note that
tools that delegate their behaviour to aspects have more than one aspects. The
reason is that there are different concerns involved in defining what the tools
should do. Typically <tt class="docutils literal"><span class="pre">ItemTool</span></tt> will be selecting the actual item and takes
care of moving it around as well. <tt class="docutils literal"><span class="pre">HandleTool</span></tt> does similar things for
handles.</p>
<p>Big changes from Gaphas 0.4 tool include:</p>
<blockquote>
<ul class="simple">
<li>Tools can contain state and should be used for one view only.</li>
<li>Grabbing is done automatically for press-move-release event sequence.</li>
<li>The _What_ is separated from the _How_, leaving less tools and less
overhead (like finding the item under the mouse pointer).</li>
</ul>
</blockquote>
<table class="docutils footnote" frame="void" id="id3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>as opposed to versions &lt; 0.5, where tools could be shared among multiple views.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>not the AOP term. The term aspect is coming from a paper by Dick Riehe: The Tools and Materials metaphore &lt;url...&gt;.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="contents.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="#">Interacting with diagrams</a><ul>
<li><a class="reference external" href="#separating-the-what-from-the-how">Separating the <em>What</em> from the <em>How</em></a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="diagram.html"
                                  title="previous chapter">Class diagram</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="ports.html"
                                  title="next chapter">Ports</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/tools.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ports.html" title="Ports"
             >next</a> |</li>
        <li class="right" >
          <a href="diagram.html" title="Class diagram"
             >previous</a> |</li>
        <li><a href="contents.html">Gaphas v0.5 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright .
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.5.
    </div>
  </body>
</html>